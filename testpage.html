<html>

<body>
    <div>
        <p>This is first paragraph!</p>
        <p>This is second paragraph!</p>
    </div>
    <div id="confirm-annotation-box" style="border:1px solid black; position:absolute; top:10px; display: none">
        <form>
            <input type="button" value="Annotate?" onclick="confirmAnnotation();" />
        </form>
    </div>
    <div id="annotation-box" style="border:1px solid black; position:absolute; top:10px; display: none">
        <form>
            <input type="text" id="annotation-comment" />
            <input type="button" value="Send annotation!" onclick="handleAnnotation();" />
        </form>
    </div>
</body>
<script src="annotation-model.js"></script>
<script>

    document.addEventListener("selectionchange", function () {
        // var selection = window.getSelection();
        // console.log('Selection changed.', selection);
        // var ab = new AnnotationBuilder().highlight(); //takes current user selection and builds an Annotation
        // var json = JSON.stringify(ab.result, false, '  '); // exports serialized version to JSON-LD
        // var output = document.getElementById('output');
        // output.value = json;
        // console.log(json)

        //  var ab2 = new AnnotationBuilder().fromJSON(json); //revives serialized version 
        //   ab2.result.target.toSelection();
        // console.log(selection.toString());

    });

    var annotationBuilder = null;

    function confirmAnnotation() {
        console.log("Confirming selection:", window.getSelection().toString());
        annotationBuilder = new AnnotationBuilder().highlight();
        document.getElementById("confirm-annotation-box").style.display = "none";
    }

    function handleAnnotation() {
        var annotationComment = document.getElementById("annotation-comment").value;
        console.log(annotationComment);
    }

    document.addEventListener("mouseup", function (event) {
        console.log("Mouse up at", event.clientX, event.clientY);

        // var annotationBox = document.getElementById("annotation-box");
        var confirmAnnotationBox = document.getElementById("confirm-annotation-box");

        if (window.getSelection().toString().length == 0) {
            confirmAnnotationBox.style.display = "none";
        } else if (confirmAnnotationBox.style.display == "none") {
            confirmAnnotationBox.style.display = "block";
            confirmAnnotationBox.style.left = event.clientX;
            confirmAnnotationBox.style.top = event.clientY;
        }

    });

</script>

</html>